<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold text-primary mb-0">ðŸ“„ Document Dashboard</h3>
    <span class="badge bg-light text-dark px-3 py-2 shadow-sm">
      Total: {{ documents.length }}
    </span>
  </div>

  <!-- Documents Table -->
  <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle mb-0">
        <thead class="bg-primary text-white">
        <tr>
          <th>ID</th>
          <th>File Name</th>
          <th>Summary</th>
          <th>Created At</th>
          <th>OCR Status</th>
          <th class="text-end">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr
          *ngFor="let doc of documents; trackBy: trackById"
          [class.table-warning]="doc.editing"
        >
          <td>{{ doc.id }}</td>

          <!-- File name -->
          <td *ngIf="!doc.editing">{{ doc.fileName }}</td>
          <td *ngIf="doc.editing">
            <input
              [(ngModel)]="doc.fileName"
              class="form-control form-control-sm"
            />
          </td>

          <!-- Summary -->
          <td *ngIf="!doc.editing">{{ doc.summary }}</td>
          <td *ngIf="doc.editing">
            <input
              [(ngModel)]="doc.summary"
              class="form-control form-control-sm"
            />
          </td>

          <td>{{ doc.createdAt | date: 'short' }}</td>

          <td>
              <span
                class="badge"
                [ngClass]="{
    'bg-warning text-dark': doc.ocrStatus === 'PENDING',
    'bg-success': doc.ocrStatus === 'COMPLETED',
    'bg-danger': doc.ocrStatus === 'FAILED'
  }"
              >
  {{ doc.ocrStatus || 'PENDING' }}
</span>

          </td>

          <td class="text-end">
            <ng-container *ngIf="!doc.editing; else editActions">
              <button
                class="btn btn-sm btn-outline-primary me-1"
                (click)="editDocument(doc)"
              >
                <i class="bi bi-pencil"></i> Edit
              </button>
              <button
                class="btn btn-sm btn-outline-danger"
                (click)="deleteDocument(doc.id)"
              >
                <i class="bi bi-trash"></i> Delete
              </button>
            </ng-container>

            <ng-template #editActions>
              <button
                class="btn btn-sm btn-success me-1"
                (click)="saveDocument(doc)"
              >
                <i class="bi bi-check-lg"></i> Save
              </button>
              <button
                class="btn btn-sm btn-warning"
                (click)="cancelEdit(doc)"
              >
                <i class="bi bi-x-lg"></i> Cancel
              </button>
            </ng-template>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Upload Section -->
  <div class="card mt-5 border-0 shadow-sm rounded-4">
    <div class="card-header bg-light fw-semibold">âž• Add New Document</div>
    <div class="card-body">
      <form
        class="row g-3 align-items-center"
        (ngSubmit)="uploadDocument(uploadForm)"
        #uploadForm="ngForm"
        enctype="multipart/form-data"
      >
        <div class="col-md-5">
          <input
            type="file"
            class="form-control"
            (change)="onFileSelected($event)"
            required
          />
        </div>
        <div class="col-md-5">
          <input
            type="text"
            class="form-control"
            placeholder="Enter summary..."
            [(ngModel)]="newDocument.summary"
            name="summary"
            required
          />
        </div>
        <div class="col-md-2 text-end">
          <button
            type="submit"
            class="btn btn-success w-100"
            [disabled]="loading"
          >
            <i class="bi bi-upload"></i>
            {{ loading ? 'Uploadingâ€¦' : 'Upload' }}
          </button>
        </div>
      </form>

      <div *ngIf="errorMsg" class="alert alert-danger mt-3 mb-0">
        {{ errorMsg }}
      </div>
    </div>
  </div>
</div>
